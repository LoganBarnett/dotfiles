[include]
  path = ~/.gitconfig-private
[color]
       status = auto
       branch = auto
       diff = auto
[init]
  defaultBranch = main
[merge]
  ff-only = true
[core]
  attributesfile = ~/dev/dotfiles/gitattributes_global
  # Now defaults to ~/.config/git/ignore
  excludesfile = ~/dev/dotfiles/gitignore_global
  editor = ~/.nix-profile/bin/vim
  # Requires git 2.19, defaults to ~/.config/git/hooks
  hooksPath = ~/dev/dotfiles/git-hooks
  #autocrlf = true
[push]
  # Prevent obnoxious guards that prevent pushing to a newly created branch to
  # its corresponding remote branch.
  default = current
  followTags = true
[alias]
  wdiff = diff --color-words
  fast-amend=commit --amend --no-edit
  unstage=reset HEAD --
  tip=log -1
  # Removes branches that have been merged already.
  tidy=!(git branch --merged | sed /^\\*/d | xargs git branch -d ); git remote prune origin
  # Removes remote branches that have been merged already. Guards against
  # some special branches that should probably be removed manually.
  tidy-remote=!git remote prune origin; git branch -r --merged | grep -v -E '^.*?/('"$(git branch --show-current)"'$|master$|develop$|main$|release)' | sed -E 's@origin/@@' | xargs -I{} git push origin :{}
  branchg=!git branch -avv | grep
[diff]
  # patience is an algorithm that is smarter and has greater context awareness
  # when performing a diff. It takes a little longer, but diffs are pretty fast as
  # it is.
  algorithm = patience
[pull]
  ff-only = true
  rebase = true
[rebase]
  autoStash = true
# Filters the npm auth token from the config file, so I don't check it into a
# public repository accidentally. Also the token stored at .npm-auth-token is
# used to restore the auth token. At the moment I have to store this token
# manually, but I could perhaps use tee during the clean filter to write the
# token to disk.
[filter "npm-auth-token"]
  clean = sed -E 's/(.*)_authToken=.*/\\1/g'
  smudge = sed -E \"s/(.*)_authToken=.*/\\1_authToken=$(cat ~/.npm-auth-token)/g\"
[filter "yarn-update-check"]
  clean = sed -E 's/(lastUpdateCheck )[0-9]+/\\1/g'
  smudge = sed -E \"s/(lastUpdateCheck )[0-9]+/\\1$(cat ~/.yarn-update-check)/g\"
[diff "gpg"]
  textconv = gpg --no-tty --decrypt
